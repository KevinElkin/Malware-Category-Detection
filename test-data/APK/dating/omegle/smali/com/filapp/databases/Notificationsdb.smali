.class public Lcom/filapp/databases/Notificationsdb;
.super Landroid/database/sqlite/SQLiteOpenHelper;
.source "Notificationsdb.java"


# instance fields
.field private database:Landroid/database/sqlite/SQLiteDatabase;

.field private table:Ljava/lang/String;


# direct methods
.method public constructor <init>(Landroid/content/Context;Ljava/lang/String;)V
    .locals 2

    .line 28
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v1, Lcom/filapp/utils/Url;->databasepath:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "Solo"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string p2, ".db"

    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p2

    const/4 v0, 0x0

    const/4 v1, 0x1

    invoke-direct {p0, p1, p2, v0, v1}, Landroid/database/sqlite/SQLiteOpenHelper;-><init>(Landroid/content/Context;Ljava/lang/String;Landroid/database/sqlite/SQLiteDatabase$CursorFactory;I)V

    const-string p1, "notifications"

    .line 24
    iput-object p1, p0, Lcom/filapp/databases/Notificationsdb;->table:Ljava/lang/String;

    return-void
.end method


# virtual methods
.method public deleteNotification(Ljava/lang/String;)V
    .locals 5

    .line 102
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 103
    iget-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    iget-object v1, p0, Lcom/filapp/databases/Notificationsdb;->table:Ljava/lang/String;

    const-string v2, "serrequestid=?"

    const/4 v3, 0x1

    new-array v3, v3, [Ljava/lang/String;

    const/4 v4, 0x0

    aput-object p1, v3, v4

    invoke-virtual {v0, v1, v2, v3}, Landroid/database/sqlite/SQLiteDatabase;->delete(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)I

    return-void
.end method

.method public getNotifications(I)Landroid/database/Cursor;
    .locals 3

    .line 69
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 70
    iget-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "SELECT * FROM notifications ORDER BY notid DESC limit 20 OFFSET "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p1

    const/4 v1, 0x0

    invoke-virtual {v0, p1, v1}, Landroid/database/sqlite/SQLiteDatabase;->rawQuery(Ljava/lang/String;[Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object p1

    return-object p1
.end method

.method public getPendindResponses()Ljava/util/List;
    .locals 11
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List<",
            "Lcom/filapp/models/Notification;",
            ">;"
        }
    .end annotation

    .line 88
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 89
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v1

    iput-object v1, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 90
    iget-object v1, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    const-string v2, "SELECT * FROM notifications WHERE nottype=\'-1\' OR nottype=\'-2\'"

    const/4 v3, 0x0

    invoke-virtual {v1, v2, v3}, Landroid/database/sqlite/SQLiteDatabase;->rawQuery(Ljava/lang/String;[Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v1

    .line 91
    invoke-interface {v1}, Landroid/database/Cursor;->moveToFirst()Z

    const/4 v2, 0x0

    move v3, v2

    .line 92
    :goto_0
    invoke-interface {v1}, Landroid/database/Cursor;->getCount()I

    move-result v4

    if-ge v3, v4, :cond_0

    .line 93
    new-instance v4, Lcom/filapp/models/Notification;

    invoke-interface {v1, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v6

    const/4 v5, 0x1

    invoke-interface {v1, v5}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v7

    const/4 v5, 0x2

    invoke-interface {v1, v5}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v8

    const/4 v5, 0x3

    invoke-interface {v1, v5}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v9

    const/4 v5, 0x4

    invoke-interface {v1, v5}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v10

    move-object v5, v4

    invoke-direct/range {v5 .. v10}, Lcom/filapp/models/Notification;-><init>(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    .line 94
    invoke-interface {v0, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 95
    invoke-interface {v1}, Landroid/database/Cursor;->moveToNext()Z

    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    .line 97
    :cond_0
    invoke-interface {v1}, Landroid/database/Cursor;->close()V

    return-object v0
.end method

.method public getTotalUnreadNotifications()I
    .locals 3

    .line 108
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 109
    iget-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    const-string v1, "SELECT * FROM notifications WHERE isread=0"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/database/sqlite/SQLiteDatabase;->rawQuery(Ljava/lang/String;[Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v0

    .line 110
    invoke-interface {v0}, Landroid/database/Cursor;->getCount()I

    move-result v0

    return v0
.end method

.method public insertnot(Lorg/json/JSONObject;Ljava/lang/String;)J
    .locals 3
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lorg/json/JSONException;
        }
    .end annotation

    .line 46
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 47
    new-instance v0, Landroid/content/ContentValues;

    invoke-direct {v0}, Landroid/content/ContentValues;-><init>()V

    const-string v1, "hostuserid"

    const-string v2, "sender"

    .line 48
    invoke-virtual {p1, v2}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v0, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string v1, "nottype"

    .line 49
    invoke-virtual {v0, v1, p2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string p2, "serrequestid"

    const-string v1, "servreqid"

    .line 50
    invoke-virtual {p1, v1}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, p2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string p2, "nottime"

    const-string v1, "timestamp"

    .line 51
    invoke-virtual {p1, v1}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object p1

    invoke-virtual {v0, p2, p1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 52
    iget-object p1, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    iget-object p2, p0, Lcom/filapp/databases/Notificationsdb;->table:Ljava/lang/String;

    const/4 v1, 0x0

    invoke-virtual {p1, p2, v1, v0}, Landroid/database/sqlite/SQLiteDatabase;->insert(Ljava/lang/String;Ljava/lang/String;Landroid/content/ContentValues;)J

    move-result-wide p1

    return-wide p1
.end method

.method public insertrevealnot(Lorg/json/JSONObject;Ljava/lang/String;)J
    .locals 3
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lorg/json/JSONException;
        }
    .end annotation

    .line 56
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 57
    new-instance v0, Landroid/content/ContentValues;

    invoke-direct {v0}, Landroid/content/ContentValues;-><init>()V

    const-string v1, "hostuserid"

    const-string v2, "sender"

    .line 58
    invoke-virtual {p1, v2}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v0, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string v1, "nottype"

    .line 59
    invoke-virtual {v0, v1, p2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string p2, "serrequestid"

    const-string v1, "servreqid"

    .line 60
    invoke-virtual {p1, v1}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, p2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string p2, "nottime"

    const-string v1, "timestamp"

    .line 61
    invoke-virtual {p1, v1}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, p2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string p2, "username"

    const-string v1, "username"

    .line 62
    invoke-virtual {p1, v1}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, p2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    const-string p2, "profilepicid"

    const-string v1, "profilepicid"

    .line 63
    invoke-virtual {p1, v1}, Lorg/json/JSONObject;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object p1

    invoke-virtual {v0, p2, p1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 64
    iget-object p1, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    iget-object p2, p0, Lcom/filapp/databases/Notificationsdb;->table:Ljava/lang/String;

    const/4 v1, 0x0

    invoke-virtual {p1, p2, v1, v0}, Landroid/database/sqlite/SQLiteDatabase;->insert(Ljava/lang/String;Ljava/lang/String;Landroid/content/ContentValues;)J

    move-result-wide p1

    return-wide p1
.end method

.method public onCreate(Landroid/database/sqlite/SQLiteDatabase;)V
    .locals 1

    const-string v0, "CREATE table allchats(chatid INTEGER PRIMARY KEY AUTOINCREMENT,servchatid text,senderid text,receiverid text,active text NOT NULL DEFAULT \'0\',notifications INTEGER NOT NULL DEFAULT 0,time text,background text  NOT NULL DEFAULT \'0\',ismute text  NOT NULL DEFAULT \'0\',isrevealed text  NOT NULL DEFAULT \'0\',username text  NOT NULL DEFAULT \'0\',profilepicid text  NOT NULL DEFAULT \'0\',lastmessage text NOT NULL DEFAULT \'\',lastmsgtime text,isdeleted NOT NULL DEFAULT \'0\')"

    .line 33
    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE table messages(msgid INTEGER PRIMARY KEY AUTOINCREMENT,servmsgid text,chatid text,mymessage text,senderid text,receiverid text,deliverystatus text,msgtype text,time text,deliverytime text,readtimetext)"

    .line 34
    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE table notifications(notid INTEGER PRIMARY KEY AUTOINCREMENT,serrequestid text,hostuserid text,nottype text,nottime text,isread INTEGER NOT NULL DEFAULT 0,isclicked INTEGER NOT NULL DEFAULT 0,username text  NOT NULL DEFAULT \'0\',profilepicid text  NOT NULL DEFAULT \'0\')"

    .line 35
    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    const-string v0, "CREATE table daterequests(reqid INTEGER PRIMARY KEY AUTOINCREMENT,serreqid text,hostid text,status text,deliverystatus text,time text)"

    .line 36
    invoke-virtual {p1, v0}, Landroid/database/sqlite/SQLiteDatabase;->execSQL(Ljava/lang/String;)V

    return-void
.end method

.method public onUpgrade(Landroid/database/sqlite/SQLiteDatabase;II)V
    .locals 0

    return-void
.end method

.method public requestrejected(Ljava/lang/String;)V
    .locals 5

    .line 75
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 76
    iget-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    iget-object v1, p0, Lcom/filapp/databases/Notificationsdb;->table:Ljava/lang/String;

    const-string v2, "notid=?"

    const/4 v3, 0x1

    new-array v3, v3, [Ljava/lang/String;

    const/4 v4, 0x0

    aput-object p1, v3, v4

    invoke-virtual {v0, v1, v2, v3}, Landroid/database/sqlite/SQLiteDatabase;->delete(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)I

    return-void
.end method

.method public setallread()V
    .locals 7

    .line 114
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 115
    new-instance v0, Landroid/content/ContentValues;

    invoke-direct {v0}, Landroid/content/ContentValues;-><init>()V

    const-string v1, "isread"

    const-string v2, "1"

    .line 116
    invoke-virtual {v0, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 117
    iget-object v1, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    iget-object v2, p0, Lcom/filapp/databases/Notificationsdb;->table:Ljava/lang/String;

    const-string v3, "isread=?"

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/String;

    const-string v5, "0"

    const/4 v6, 0x0

    aput-object v5, v4, v6

    invoke-virtual {v1, v2, v0, v3, v4}, Landroid/database/sqlite/SQLiteDatabase;->update(Ljava/lang/String;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    return-void
.end method

.method public updatestatus(Ljava/lang/String;Ljava/lang/String;)V
    .locals 5

    .line 80
    invoke-virtual {p0}, Lcom/filapp/databases/Notificationsdb;->getWritableDatabase()Landroid/database/sqlite/SQLiteDatabase;

    move-result-object v0

    iput-object v0, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    .line 81
    new-instance v0, Landroid/content/ContentValues;

    invoke-direct {v0}, Landroid/content/ContentValues;-><init>()V

    const-string v1, "nottype"

    .line 82
    invoke-virtual {v0, v1, p2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 83
    iget-object p2, p0, Lcom/filapp/databases/Notificationsdb;->database:Landroid/database/sqlite/SQLiteDatabase;

    iget-object v1, p0, Lcom/filapp/databases/Notificationsdb;->table:Ljava/lang/String;

    const-string v2, "notid=?"

    const/4 v3, 0x1

    new-array v3, v3, [Ljava/lang/String;

    const/4 v4, 0x0

    aput-object p1, v3, v4

    invoke-virtual {p2, v1, v0, v2, v3}, Landroid/database/sqlite/SQLiteDatabase;->update(Ljava/lang/String;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    return-void
.end method
