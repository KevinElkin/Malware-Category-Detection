.class public Lcom/digits/sdk/android/DigitsClient;
.super Ljava/lang/Object;
.source "DigitsClient.java"


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/digits/sdk/android/DigitsClient$CallbackWrapper;
    }
.end annotation


# static fields
.field public static final CLIENT_IDENTIFIER:Ljava/lang/String; = "digits_sdk"

.field public static final EXTRA_AUTH_CONFIG:Ljava/lang/String; = "auth_config"

.field public static final EXTRA_EMAIL:Ljava/lang/String; = "email_enabled"

.field public static final EXTRA_EVENT_DETAILS_BUILDER:Ljava/lang/String; = "digits_event_details_builder"

.field public static final EXTRA_FALLBACK_REASON:Ljava/lang/String; = "fallback_reason"

.field public static final EXTRA_PHONE:Ljava/lang/String; = "phone_number"

.field public static final EXTRA_REQUEST_ID:Ljava/lang/String; = "request_id"

.field public static final EXTRA_RESULT_RECEIVER:Ljava/lang/String; = "receiver"

.field public static final EXTRA_USER_ID:Ljava/lang/String; = "user_id"

.field public static final THIRD_PARTY_CONFIRMATION_CODE:Ljava/lang/String; = "third_party_confirmation_code"


# instance fields
.field private final apiClientManager:Lcom/digits/sdk/android/DigitsApiClientManager;

.field private final authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

.field private final digits:Lcom/digits/sdk/android/Digits;

.field private final digitsEventCollector:Lcom/digits/sdk/android/DigitsEventCollector;

.field private sandboxConfig:Lcom/digits/sdk/android/SandboxConfig;

.field private final sessionManager:Lcom/twitter/sdk/android/core/SessionManager;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/twitter/sdk/android/core/SessionManager",
            "<",
            "Lcom/digits/sdk/android/DigitsSession;",
            ">;"
        }
    .end annotation
.end field


# direct methods
.method constructor <init>(Lcom/digits/sdk/android/Digits;Lcom/twitter/sdk/android/core/SessionManager;Lcom/digits/sdk/android/DigitsApiClientManager;Lcom/digits/sdk/android/DigitsAuthRequestQueue;Lcom/digits/sdk/android/DigitsEventCollector;Lcom/digits/sdk/android/SandboxConfig;)V
    .locals 2
    .param p1, "digits"    # Lcom/digits/sdk/android/Digits;
    .param p3, "apiClientManager"    # Lcom/digits/sdk/android/DigitsApiClientManager;
    .param p4, "authRequestQueue"    # Lcom/digits/sdk/android/DigitsAuthRequestQueue;
    .param p5, "digitsEventCollector"    # Lcom/digits/sdk/android/DigitsEventCollector;
    .param p6, "sandboxConfig"    # Lcom/digits/sdk/android/SandboxConfig;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/digits/sdk/android/Digits;",
            "Lcom/twitter/sdk/android/core/SessionManager",
            "<",
            "Lcom/digits/sdk/android/DigitsSession;",
            ">;",
            "Lcom/digits/sdk/android/DigitsApiClientManager;",
            "Lcom/digits/sdk/android/DigitsAuthRequestQueue;",
            "Lcom/digits/sdk/android/DigitsEventCollector;",
            "Lcom/digits/sdk/android/SandboxConfig;",
            ")V"
        }
    .end annotation

    .prologue
    .line 66
    .local p2, "sessionManager":Lcom/twitter/sdk/android/core/SessionManager;, "Lcom/twitter/sdk/android/core/SessionManager<Lcom/digits/sdk/android/DigitsSession;>;"
    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    .line 68
    iput-object p3, p0, Lcom/digits/sdk/android/DigitsClient;->apiClientManager:Lcom/digits/sdk/android/DigitsApiClientManager;

    .line 69
    iput-object p1, p0, Lcom/digits/sdk/android/DigitsClient;->digits:Lcom/digits/sdk/android/Digits;

    .line 70
    iput-object p2, p0, Lcom/digits/sdk/android/DigitsClient;->sessionManager:Lcom/twitter/sdk/android/core/SessionManager;

    .line 71
    iput-object p6, p0, Lcom/digits/sdk/android/DigitsClient;->sandboxConfig:Lcom/digits/sdk/android/SandboxConfig;

    .line 73
    if-nez p4, :cond_0

    .line 74
    invoke-virtual {p0, p2}, Lcom/digits/sdk/android/DigitsClient;->createAuthRequestQueue(Lcom/twitter/sdk/android/core/SessionManager;)Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    move-result-object v0

    iput-object v0, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    .line 75
    iget-object v0, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    const/4 v1, 0x0

    invoke-virtual {v0, v1}, Lcom/digits/sdk/android/DigitsAuthRequestQueue;->sessionRestored(Lcom/twitter/sdk/android/core/Session;)V

    .line 79
    :goto_0
    iput-object p5, p0, Lcom/digits/sdk/android/DigitsClient;->digitsEventCollector:Lcom/digits/sdk/android/DigitsEventCollector;

    .line 80
    return-void

    .line 77
    :cond_0
    iput-object p4, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    goto :goto_0
.end method

.method constructor <init>(Lcom/digits/sdk/android/DigitsApiClientManager;)V
    .locals 7
    .param p1, "apiClientManager"    # Lcom/digits/sdk/android/DigitsApiClientManager;

    .prologue
    .line 57
    invoke-static {}, Lcom/digits/sdk/android/Digits;->getInstance()Lcom/digits/sdk/android/Digits;

    move-result-object v1

    invoke-static {}, Lcom/digits/sdk/android/Digits;->getSessionManager()Lcom/twitter/sdk/android/core/SessionManager;

    move-result-object v2

    const/4 v4, 0x0

    invoke-static {}, Lcom/digits/sdk/android/Digits;->getInstance()Lcom/digits/sdk/android/Digits;

    move-result-object v0

    invoke-virtual {v0}, Lcom/digits/sdk/android/Digits;->getDigitsEventCollector()Lcom/digits/sdk/android/DigitsEventCollector;

    move-result-object v5

    invoke-static {}, Lcom/digits/sdk/android/Digits;->getInstance()Lcom/digits/sdk/android/Digits;

    move-result-object v0

    invoke-virtual {v0}, Lcom/digits/sdk/android/Digits;->getSandboxConfig()Lcom/digits/sdk/android/SandboxConfig;

    move-result-object v6

    move-object v0, p0

    move-object v3, p1

    invoke-direct/range {v0 .. v6}, Lcom/digits/sdk/android/DigitsClient;-><init>(Lcom/digits/sdk/android/Digits;Lcom/twitter/sdk/android/core/SessionManager;Lcom/digits/sdk/android/DigitsApiClientManager;Lcom/digits/sdk/android/DigitsAuthRequestQueue;Lcom/digits/sdk/android/DigitsEventCollector;Lcom/digits/sdk/android/SandboxConfig;)V

    .line 60
    return-void
.end method

.method static synthetic access$000(Lcom/digits/sdk/android/DigitsClient;)Lcom/digits/sdk/android/DigitsEventCollector;
    .locals 1
    .param p0, "x0"    # Lcom/digits/sdk/android/DigitsClient;

    .prologue
    .line 37
    iget-object v0, p0, Lcom/digits/sdk/android/DigitsClient;->digitsEventCollector:Lcom/digits/sdk/android/DigitsEventCollector;

    return-object v0
.end method

.method private createBundleForAuthFlow(Lcom/digits/sdk/android/DigitsAuthConfig;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;)Landroid/os/Bundle;
    .locals 3
    .param p1, "digitsAuthConfig"    # Lcom/digits/sdk/android/DigitsAuthConfig;
    .param p2, "digitsEventDetailsBuilder"    # Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    .prologue
    .line 136
    new-instance v0, Landroid/os/Bundle;

    invoke-direct {v0}, Landroid/os/Bundle;-><init>()V

    .line 138
    .local v0, "bundle":Landroid/os/Bundle;
    const-string v1, "receiver"

    iget-object v2, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->authCallback:Lcom/digits/sdk/android/AuthCallback;

    invoke-virtual {p0, v2}, Lcom/digits/sdk/android/DigitsClient;->createResultReceiver(Lcom/digits/sdk/android/AuthCallback;)Lcom/digits/sdk/android/LoginResultReceiver;

    move-result-object v2

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putParcelable(Ljava/lang/String;Landroid/os/Parcelable;)V

    .line 140
    const-string v1, "phone_number"

    iget-object v2, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->phoneNumber:Ljava/lang/String;

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 141
    const-string v1, "email_enabled"

    iget-boolean v2, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->isEmailRequired:Z

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V

    .line 142
    const-string v1, "digits_event_details_builder"

    invoke-virtual {v0, v1, p2}, Landroid/os/Bundle;->putParcelable(Ljava/lang/String;Landroid/os/Parcelable;)V

    .line 143
    return-object v0
.end method

.method private getPartnerKeyByConsumerKey(Ljava/lang/String;)Ljava/lang/String;
    .locals 3
    .param p1, "consumerKey"    # Ljava/lang/String;

    .prologue
    .line 130
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "__Digits@P@rtner__"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 131
    .local v0, "toEncode":Ljava/lang/String;
    const-string v1, "UTF-8"

    invoke-static {v1}, Ljava/nio/charset/Charset;->forName(Ljava/lang/String;)Ljava/nio/charset/Charset;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/String;->getBytes(Ljava/nio/charset/Charset;)[B

    move-result-object v1

    const/4 v2, 0x2

    invoke-static {v1, v2}, Landroid/util/Base64;->encodeToString([BI)Ljava/lang/String;

    move-result-object v1

    return-object v1
.end method

.method private isAuthorizedPartner(Lcom/digits/sdk/android/DigitsAuthConfig;)Z
    .locals 4
    .param p1, "digitsAuthConfig"    # Lcom/digits/sdk/android/DigitsAuthConfig;

    .prologue
    .line 122
    iget-object v2, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->partnerKey:Ljava/lang/String;

    .line 123
    .local v2, "partnerKey":Ljava/lang/String;
    iget-object v3, p0, Lcom/digits/sdk/android/DigitsClient;->digits:Lcom/digits/sdk/android/Digits;

    invoke-virtual {v3}, Lcom/digits/sdk/android/Digits;->getAuthConfig()Lcom/twitter/sdk/android/core/TwitterAuthConfig;

    move-result-object v3

    invoke-virtual {v3}, Lcom/twitter/sdk/android/core/TwitterAuthConfig;->getConsumerKey()Ljava/lang/String;

    move-result-object v0

    .line 125
    .local v0, "consumerKey":Ljava/lang/String;
    invoke-direct {p0, v0}, Lcom/digits/sdk/android/DigitsClient;->getPartnerKeyByConsumerKey(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    .line 126
    .local v1, "expectedPartnerKey":Ljava/lang/String;
    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    return v3
.end method

.method private startPhoneNumberActivity(Landroid/os/Bundle;)V
    .locals 6
    .param p1, "bundle"    # Landroid/os/Bundle;

    .prologue
    .line 151
    iget-object v5, p0, Lcom/digits/sdk/android/DigitsClient;->digits:Lcom/digits/sdk/android/Digits;

    invoke-virtual {v5}, Lcom/digits/sdk/android/Digits;->getContext()Landroid/content/Context;

    move-result-object v0

    .line 152
    .local v0, "appContext":Landroid/content/Context;
    iget-object v5, p0, Lcom/digits/sdk/android/DigitsClient;->digits:Lcom/digits/sdk/android/Digits;

    invoke-virtual {v5}, Lcom/digits/sdk/android/Digits;->getFabric()Lio/fabric/sdk/android/Fabric;

    move-result-object v5

    invoke-virtual {v5}, Lio/fabric/sdk/android/Fabric;->getCurrentActivity()Landroid/app/Activity;

    move-result-object v1

    .line 154
    .local v1, "currentActivity":Landroid/app/Activity;
    if-eqz v1, :cond_0

    invoke-virtual {v1}, Landroid/app/Activity;->isFinishing()Z

    move-result v5

    if-nez v5, :cond_0

    move-object v4, v1

    .line 156
    .local v4, "selectedContext":Landroid/content/Context;
    :goto_0
    if-eqz v1, :cond_1

    invoke-virtual {v1}, Landroid/app/Activity;->isFinishing()Z

    move-result v5

    if-nez v5, :cond_1

    const/4 v3, 0x0

    .line 159
    .local v3, "intentFlags":I
    :goto_1
    new-instance v2, Landroid/content/Intent;

    iget-object v5, p0, Lcom/digits/sdk/android/DigitsClient;->digits:Lcom/digits/sdk/android/Digits;

    invoke-virtual {v5}, Lcom/digits/sdk/android/Digits;->getActivityClassManager()Lcom/digits/sdk/android/ActivityClassManager;

    move-result-object v5

    invoke-interface {v5}, Lcom/digits/sdk/android/ActivityClassManager;->getPhoneNumberActivity()Ljava/lang/Class;

    move-result-object v5

    invoke-direct {v2, v4, v5}, Landroid/content/Intent;-><init>(Landroid/content/Context;Ljava/lang/Class;)V

    .line 162
    .local v2, "intent":Landroid/content/Intent;
    invoke-virtual {v2, p1}, Landroid/content/Intent;->putExtras(Landroid/os/Bundle;)Landroid/content/Intent;

    .line 163
    invoke-virtual {v2, v3}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 164
    invoke-virtual {v4, v2}, Landroid/content/Context;->startActivity(Landroid/content/Intent;)V

    .line 165
    return-void

    .end local v2    # "intent":Landroid/content/Intent;
    .end local v3    # "intentFlags":I
    .end local v4    # "selectedContext":Landroid/content/Context;
    :cond_0
    move-object v4, v0

    .line 154
    goto :goto_0

    .line 156
    .restart local v4    # "selectedContext":Landroid/content/Context;
    :cond_1
    const/high16 v3, 0x14000000

    goto :goto_1
.end method


# virtual methods
.method protected authDevice(Ljava/lang/String;Lcom/digits/sdk/android/Verification;Lcom/twitter/sdk/android/core/Callback;)V
    .locals 2
    .param p1, "phoneNumber"    # Ljava/lang/String;
    .param p2, "verificationType"    # Lcom/digits/sdk/android/Verification;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Lcom/digits/sdk/android/Verification;",
            "Lcom/twitter/sdk/android/core/Callback",
            "<",
            "Lcom/digits/sdk/android/AuthResponse;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 169
    .local p3, "callback":Lcom/twitter/sdk/android/core/Callback;, "Lcom/twitter/sdk/android/core/Callback<Lcom/digits/sdk/android/AuthResponse;>;"
    iget-object v0, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    new-instance v1, Lcom/digits/sdk/android/DigitsClient$1;

    invoke-direct {v1, p0, p3, p1, p2}, Lcom/digits/sdk/android/DigitsClient$1;-><init>(Lcom/digits/sdk/android/DigitsClient;Lcom/twitter/sdk/android/core/Callback;Ljava/lang/String;Lcom/digits/sdk/android/Verification;)V

    invoke-virtual {v0, v1}, Lcom/digits/sdk/android/DigitsAuthRequestQueue;->addClientRequest(Lcom/twitter/sdk/android/core/Callback;)Z

    .line 178
    return-void
.end method

.method protected createAccount(Ljava/lang/String;Ljava/lang/String;Lcom/twitter/sdk/android/core/Callback;)V
    .locals 2
    .param p1, "pin"    # Ljava/lang/String;
    .param p2, "phoneNumber"    # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Lcom/twitter/sdk/android/core/Callback",
            "<",
            "Lcom/digits/sdk/android/DigitsUser;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 182
    .local p3, "callback":Lcom/twitter/sdk/android/core/Callback;, "Lcom/twitter/sdk/android/core/Callback<Lcom/digits/sdk/android/DigitsUser;>;"
    iget-object v0, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    new-instance v1, Lcom/digits/sdk/android/DigitsClient$2;

    invoke-direct {v1, p0, p3, p2, p1}, Lcom/digits/sdk/android/DigitsClient$2;-><init>(Lcom/digits/sdk/android/DigitsClient;Lcom/twitter/sdk/android/core/Callback;Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v0, v1}, Lcom/digits/sdk/android/DigitsAuthRequestQueue;->addClientRequest(Lcom/twitter/sdk/android/core/Callback;)Z

    .line 190
    return-void
.end method

.method protected createAuthRequestQueue(Lcom/twitter/sdk/android/core/SessionManager;)Lcom/digits/sdk/android/DigitsAuthRequestQueue;
    .locals 4
    .param p1, "sessionManager"    # Lcom/twitter/sdk/android/core/SessionManager;

    .prologue
    .line 83
    new-instance v0, Ljava/util/ArrayList;

    const/4 v2, 0x1

    invoke-direct {v0, v2}, Ljava/util/ArrayList;-><init>(I)V

    .line 84
    .local v0, "sessionManagers":Ljava/util/List;, "Ljava/util/List<Lcom/twitter/sdk/android/core/SessionManager<+Lcom/twitter/sdk/android/core/Session;>;>;"
    invoke-interface {v0, p1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 85
    new-instance v1, Lcom/digits/sdk/android/DigitsGuestSessionProvider;

    invoke-direct {v1, p1, v0}, Lcom/digits/sdk/android/DigitsGuestSessionProvider;-><init>(Lcom/twitter/sdk/android/core/SessionManager;Ljava/util/List;)V

    .line 87
    .local v1, "sessionProvider":Lcom/digits/sdk/android/DigitsGuestSessionProvider;
    new-instance v2, Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    iget-object v3, p0, Lcom/digits/sdk/android/DigitsClient;->apiClientManager:Lcom/digits/sdk/android/DigitsApiClientManager;

    invoke-direct {v2, v3, v1}, Lcom/digits/sdk/android/DigitsAuthRequestQueue;-><init>(Lcom/digits/sdk/android/DigitsApiClientManager;Lcom/twitter/sdk/android/core/internal/SessionProvider;)V

    return-object v2
.end method

.method createCompositeCallback(Lcom/digits/sdk/android/DigitsAuthConfig;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;)Lcom/digits/sdk/android/LoginOrSignupComposer;
    .locals 13
    .param p1, "digitsAuthConfig"    # Lcom/digits/sdk/android/DigitsAuthConfig;
    .param p2, "outerDetails"    # Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    .prologue
    .line 211
    iget-object v0, p0, Lcom/digits/sdk/android/DigitsClient;->digits:Lcom/digits/sdk/android/Digits;

    invoke-virtual {v0}, Lcom/digits/sdk/android/Digits;->getContext()Landroid/content/Context;

    move-result-object v2

    .line 212
    .local v2, "context":Landroid/content/Context;
    invoke-static {}, Lcom/digits/sdk/android/Digits;->getInstance()Lcom/digits/sdk/android/Digits;

    move-result-object v0

    invoke-virtual {v0}, Lcom/digits/sdk/android/Digits;->getActivityClassManager()Lcom/digits/sdk/android/ActivityClassManager;

    move-result-object v9

    .line 215
    .local v9, "activityClassManager":Lcom/digits/sdk/android/ActivityClassManager;
    new-instance v0, Lcom/digits/sdk/android/DigitsClient$3;

    iget-object v4, p0, Lcom/digits/sdk/android/DigitsClient;->sessionManager:Lcom/twitter/sdk/android/core/SessionManager;

    iget-object v5, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->phoneNumber:Ljava/lang/String;

    sget-object v6, Lcom/digits/sdk/android/Verification;->sms:Lcom/digits/sdk/android/Verification;

    iget-boolean v7, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->isEmailRequired:Z

    iget-object v1, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->authCallback:Lcom/digits/sdk/android/AuthCallback;

    invoke-virtual {p0, v1}, Lcom/digits/sdk/android/DigitsClient;->createResultReceiver(Lcom/digits/sdk/android/AuthCallback;)Lcom/digits/sdk/android/LoginResultReceiver;

    move-result-object v8

    move-object v1, p0

    move-object v3, p0

    move-object v10, p2

    move-object v11, p2

    move-object v12, p1

    invoke-direct/range {v0 .. v12}, Lcom/digits/sdk/android/DigitsClient$3;-><init>(Lcom/digits/sdk/android/DigitsClient;Landroid/content/Context;Lcom/digits/sdk/android/DigitsClient;Lcom/twitter/sdk/android/core/SessionManager;Ljava/lang/String;Lcom/digits/sdk/android/Verification;ZLandroid/os/ResultReceiver;Lcom/digits/sdk/android/ActivityClassManager;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;Lcom/digits/sdk/android/DigitsAuthConfig;)V

    return-object v0
.end method

.method createResultReceiver(Lcom/digits/sdk/android/AuthCallback;)Lcom/digits/sdk/android/LoginResultReceiver;
    .locals 2
    .param p1, "callback"    # Lcom/digits/sdk/android/AuthCallback;

    .prologue
    .line 147
    new-instance v0, Lcom/digits/sdk/android/LoginResultReceiver;

    iget-object v1, p0, Lcom/digits/sdk/android/DigitsClient;->sessionManager:Lcom/twitter/sdk/android/core/SessionManager;

    invoke-direct {v0, p1, v1}, Lcom/digits/sdk/android/LoginResultReceiver;-><init>(Lcom/digits/sdk/android/AuthCallback;Lcom/twitter/sdk/android/core/SessionManager;)V

    return-object v0
.end method

.method protected loginDevice(Ljava/lang/String;JLjava/lang/String;Lcom/twitter/sdk/android/core/Callback;)V
    .locals 8
    .param p1, "requestId"    # Ljava/lang/String;
    .param p2, "userId"    # J
    .param p4, "code"    # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "J",
            "Ljava/lang/String;",
            "Lcom/twitter/sdk/android/core/Callback",
            "<",
            "Lcom/digits/sdk/android/DigitsSessionResponse;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 238
    .local p5, "callback":Lcom/twitter/sdk/android/core/Callback;, "Lcom/twitter/sdk/android/core/Callback<Lcom/digits/sdk/android/DigitsSessionResponse;>;"
    iget-object v7, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    new-instance v0, Lcom/digits/sdk/android/DigitsClient$4;

    move-object v1, p0

    move-object v2, p5

    move-object v3, p1

    move-wide v4, p2

    move-object v6, p4

    invoke-direct/range {v0 .. v6}, Lcom/digits/sdk/android/DigitsClient$4;-><init>(Lcom/digits/sdk/android/DigitsClient;Lcom/twitter/sdk/android/core/Callback;Ljava/lang/String;JLjava/lang/String;)V

    invoke-virtual {v7, v0}, Lcom/digits/sdk/android/DigitsAuthRequestQueue;->addClientRequest(Lcom/twitter/sdk/android/core/Callback;)Z

    .line 246
    return-void
.end method

.method protected registerDevice(Ljava/lang/String;Lcom/digits/sdk/android/Verification;Lcom/twitter/sdk/android/core/Callback;)V
    .locals 2
    .param p1, "phoneNumber"    # Ljava/lang/String;
    .param p2, "verificationType"    # Lcom/digits/sdk/android/Verification;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Lcom/digits/sdk/android/Verification;",
            "Lcom/twitter/sdk/android/core/Callback",
            "<",
            "Lcom/digits/sdk/android/DeviceRegistrationResponse;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 250
    .local p3, "callback":Lcom/twitter/sdk/android/core/Callback;, "Lcom/twitter/sdk/android/core/Callback<Lcom/digits/sdk/android/DeviceRegistrationResponse;>;"
    iget-object v0, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    new-instance v1, Lcom/digits/sdk/android/DigitsClient$5;

    invoke-direct {v1, p0, p3, p1, p2}, Lcom/digits/sdk/android/DigitsClient$5;-><init>(Lcom/digits/sdk/android/DigitsClient;Lcom/twitter/sdk/android/core/Callback;Ljava/lang/String;Lcom/digits/sdk/android/Verification;)V

    invoke-virtual {v0, v1}, Lcom/digits/sdk/android/DigitsAuthRequestQueue;->addClientRequest(Lcom/twitter/sdk/android/core/Callback;)Z

    .line 262
    return-void
.end method

.method protected sendConfirmationCode(Lcom/digits/sdk/android/DigitsAuthConfig;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;)V
    .locals 6
    .param p1, "digitsAuthConfig"    # Lcom/digits/sdk/android/DigitsAuthConfig;
    .param p2, "outerDetails"    # Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    .prologue
    .line 194
    iget-object v3, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->phoneNumber:Ljava/lang/String;

    invoke-static {v3}, Lcom/digits/sdk/android/PhoneNumberUtils;->getPhoneNumber(Ljava/lang/String;)Lcom/digits/sdk/android/PhoneNumber;

    move-result-object v1

    .line 197
    .local v1, "phoneNumber":Lcom/digits/sdk/android/PhoneNumber;
    invoke-virtual {v1}, Lcom/digits/sdk/android/PhoneNumber;->getCountryIso()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->withCountry(Ljava/lang/String;)Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    move-result-object v3

    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v4

    invoke-static {v4, v5}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v4

    invoke-virtual {v3, v4}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->withCurrentTime(Ljava/lang/Long;)Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    move-result-object v0

    .line 201
    .local v0, "details":Lcom/digits/sdk/android/DigitsEventDetailsBuilder;
    iget-object v3, p0, Lcom/digits/sdk/android/DigitsClient;->digitsEventCollector:Lcom/digits/sdk/android/DigitsEventCollector;

    invoke-virtual {v0}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->build()Lcom/digits/sdk/android/DigitsEventDetails;

    move-result-object v4

    invoke-virtual {v3, v4}, Lcom/digits/sdk/android/DigitsEventCollector;->submitClickOnPhoneScreen(Lcom/digits/sdk/android/DigitsEventDetails;)V

    .line 203
    invoke-virtual {p0, p1, v0}, Lcom/digits/sdk/android/DigitsClient;->createCompositeCallback(Lcom/digits/sdk/android/DigitsAuthConfig;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;)Lcom/digits/sdk/android/LoginOrSignupComposer;

    move-result-object v2

    .line 206
    .local v2, "signupAndLoginCombinedCallback":Lcom/digits/sdk/android/LoginOrSignupComposer;
    invoke-virtual {v2}, Lcom/digits/sdk/android/LoginOrSignupComposer;->start()V

    .line 207
    return-void
.end method

.method protected startSignUp(Lcom/digits/sdk/android/DigitsAuthConfig;)V
    .locals 10
    .param p1, "digitsAuthConfig"    # Lcom/digits/sdk/android/DigitsAuthConfig;

    .prologue
    .line 91
    iget-object v6, p0, Lcom/digits/sdk/android/DigitsClient;->sessionManager:Lcom/twitter/sdk/android/core/SessionManager;

    invoke-interface {v6}, Lcom/twitter/sdk/android/core/SessionManager;->getActiveSession()Lcom/twitter/sdk/android/core/Session;

    move-result-object v5

    check-cast v5, Lcom/digits/sdk/android/DigitsSession;

    .line 92
    .local v5, "session":Lcom/digits/sdk/android/DigitsSession;
    iget-object v6, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->confirmationCodeCallback:Lcom/digits/sdk/android/ConfirmationCodeCallback;

    if-eqz v6, :cond_0

    const/4 v3, 0x1

    .line 93
    .local v3, "isCustomPhoneUI":Z
    :goto_0
    invoke-direct {p0, p1}, Lcom/digits/sdk/android/DigitsClient;->isAuthorizedPartner(Lcom/digits/sdk/android/DigitsAuthConfig;)Z

    move-result v2

    .line 94
    .local v2, "isAuthorizedPartner":Z
    new-instance v6, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    invoke-direct {v6}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;-><init>()V

    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v8

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    invoke-virtual {v6, v7}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->withAuthStartTime(Ljava/lang/Long;)Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    move-result-object v6

    invoke-static {}, Ljava/util/Locale;->getDefault()Ljava/util/Locale;

    move-result-object v7

    invoke-virtual {v7}, Ljava/util/Locale;->getLanguage()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->withLanguage(Ljava/lang/String;)Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    move-result-object v6

    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v8

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    invoke-virtual {v6, v7}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->withCurrentTime(Ljava/lang/Long;)Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    move-result-object v1

    .line 99
    .local v1, "details":Lcom/digits/sdk/android/DigitsEventDetailsBuilder;
    iget-object v6, p0, Lcom/digits/sdk/android/DigitsClient;->digitsEventCollector:Lcom/digits/sdk/android/DigitsEventCollector;

    invoke-virtual {v1}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->build()Lcom/digits/sdk/android/DigitsEventDetails;

    move-result-object v7

    invoke-virtual {v6, v7}, Lcom/digits/sdk/android/DigitsEventCollector;->authImpression(Lcom/digits/sdk/android/DigitsEventDetails;)V

    .line 101
    if-eqz v5, :cond_1

    invoke-virtual {v5}, Lcom/digits/sdk/android/DigitsSession;->isLoggedOutUser()Z

    move-result v6

    if-nez v6, :cond_1

    .line 102
    iget-object v6, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->phoneNumber:Ljava/lang/String;

    invoke-static {v6}, Lcom/digits/sdk/android/PhoneNumberUtils;->getPhoneNumber(Ljava/lang/String;)Lcom/digits/sdk/android/PhoneNumber;

    move-result-object v4

    .line 104
    .local v4, "phoneNumber":Lcom/digits/sdk/android/PhoneNumber;
    iget-object v6, p0, Lcom/digits/sdk/android/DigitsClient;->digitsEventCollector:Lcom/digits/sdk/android/DigitsEventCollector;

    invoke-virtual {v4}, Lcom/digits/sdk/android/PhoneNumber;->getCountryIso()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v1, v7}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->withCountry(Ljava/lang/String;)Lcom/digits/sdk/android/DigitsEventDetailsBuilder;

    move-result-object v7

    invoke-virtual {v7}, Lcom/digits/sdk/android/DigitsEventDetailsBuilder;->build()Lcom/digits/sdk/android/DigitsEventDetails;

    move-result-object v7

    invoke-virtual {v6, v7}, Lcom/digits/sdk/android/DigitsEventCollector;->authSuccess(Lcom/digits/sdk/android/DigitsEventDetails;)V

    .line 106
    iget-object v6, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->authCallback:Lcom/digits/sdk/android/AuthCallback;

    invoke-virtual {v5}, Lcom/digits/sdk/android/DigitsSession;->getPhoneNumber()Ljava/lang/String;

    move-result-object v7

    invoke-interface {v6, v5, v7}, Lcom/digits/sdk/android/AuthCallback;->success(Lcom/digits/sdk/android/DigitsSession;Ljava/lang/String;)V

    .line 119
    .end local v4    # "phoneNumber":Lcom/digits/sdk/android/PhoneNumber;
    :goto_1
    return-void

    .line 92
    .end local v1    # "details":Lcom/digits/sdk/android/DigitsEventDetailsBuilder;
    .end local v2    # "isAuthorizedPartner":Z
    .end local v3    # "isCustomPhoneUI":Z
    :cond_0
    const/4 v3, 0x0

    goto :goto_0

    .line 107
    .restart local v1    # "details":Lcom/digits/sdk/android/DigitsEventDetailsBuilder;
    .restart local v2    # "isAuthorizedPartner":Z
    .restart local v3    # "isCustomPhoneUI":Z
    :cond_1
    iget-object v6, p0, Lcom/digits/sdk/android/DigitsClient;->sandboxConfig:Lcom/digits/sdk/android/SandboxConfig;

    sget-object v7, Lcom/digits/sdk/android/SandboxConfig$Mode;->DEFAULT:Lcom/digits/sdk/android/SandboxConfig$Mode;

    invoke-virtual {v6, v7}, Lcom/digits/sdk/android/SandboxConfig;->isMode(Lcom/digits/sdk/android/SandboxConfig$Mode;)Z

    move-result v6

    if-eqz v6, :cond_2

    .line 108
    invoke-static {}, Lcom/digits/sdk/android/MockApiInterface;->createDigitsSession()Lcom/digits/sdk/android/DigitsSession;

    move-result-object v0

    .line 109
    .local v0, "blackboxSession":Lcom/digits/sdk/android/DigitsSession;
    iget-object v6, p1, Lcom/digits/sdk/android/DigitsAuthConfig;->authCallback:Lcom/digits/sdk/android/AuthCallback;

    invoke-virtual {v0}, Lcom/digits/sdk/android/DigitsSession;->getPhoneNumber()Ljava/lang/String;

    move-result-object v7

    invoke-interface {v6, v0, v7}, Lcom/digits/sdk/android/AuthCallback;->success(Lcom/digits/sdk/android/DigitsSession;Ljava/lang/String;)V

    goto :goto_1

    .line 111
    .end local v0    # "blackboxSession":Lcom/digits/sdk/android/DigitsSession;
    :cond_2
    if-eqz v3, :cond_3

    if-eqz v2, :cond_3

    .line 112
    invoke-virtual {p0, p1, v1}, Lcom/digits/sdk/android/DigitsClient;->sendConfirmationCode(Lcom/digits/sdk/android/DigitsAuthConfig;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;)V

    goto :goto_1

    .line 113
    :cond_3
    if-eqz v3, :cond_4

    .line 114
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "Invalid partner key"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 116
    :cond_4
    invoke-direct {p0, p1, v1}, Lcom/digits/sdk/android/DigitsClient;->createBundleForAuthFlow(Lcom/digits/sdk/android/DigitsAuthConfig;Lcom/digits/sdk/android/DigitsEventDetailsBuilder;)Landroid/os/Bundle;

    move-result-object v6

    invoke-direct {p0, v6}, Lcom/digits/sdk/android/DigitsClient;->startPhoneNumberActivity(Landroid/os/Bundle;)V

    goto :goto_1
.end method

.method protected verifyPin(Ljava/lang/String;JLjava/lang/String;Lcom/twitter/sdk/android/core/Callback;)V
    .locals 8
    .param p1, "requestId"    # Ljava/lang/String;
    .param p2, "userId"    # J
    .param p4, "pin"    # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "J",
            "Ljava/lang/String;",
            "Lcom/twitter/sdk/android/core/Callback",
            "<",
            "Lcom/digits/sdk/android/DigitsSessionResponse;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 266
    .local p5, "callback":Lcom/twitter/sdk/android/core/Callback;, "Lcom/twitter/sdk/android/core/Callback<Lcom/digits/sdk/android/DigitsSessionResponse;>;"
    iget-object v7, p0, Lcom/digits/sdk/android/DigitsClient;->authRequestQueue:Lcom/digits/sdk/android/DigitsAuthRequestQueue;

    new-instance v0, Lcom/digits/sdk/android/DigitsClient$6;

    move-object v1, p0

    move-object v2, p5

    move-object v3, p1

    move-wide v4, p2

    move-object v6, p4

    invoke-direct/range {v0 .. v6}, Lcom/digits/sdk/android/DigitsClient$6;-><init>(Lcom/digits/sdk/android/DigitsClient;Lcom/twitter/sdk/android/core/Callback;Ljava/lang/String;JLjava/lang/String;)V

    invoke-virtual {v7, v0}, Lcom/digits/sdk/android/DigitsAuthRequestQueue;->addClientRequest(Lcom/twitter/sdk/android/core/Callback;)Z

    .line 274
    return-void
.end method
