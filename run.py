
import src.scrape_apk as scraper
import src.create_matrices as cm
import src.model as model
import json
import os
from random import sample


def get_apk(**kwargs):
    """
    method to unzip apk files downloaded from APKPure.com
    """
    outpath = './' + kwargs['outpath']
    if not os.path.exists(outpath):
            os.mkdir(outpath)

    if kwargs['scrape_data']:
        scraper.run_scraper(kwargs['categories'], kwargs['number_of_apps_per_cat'],kwargs['outpath'])
    category_data,apps,apis,malware = cm.get_metadata(kwargs['categories'], kwargs['outpath'],kwargs['re_read'] ,kwargs['malware_path'])
    kernels = cm.get_kernels(category_data,apps,apis)
    malware = [3,6,10,4]
    model.run_model(kernels,malware)

    
    
    
    


if __name__== "__main__":
    #params - number_of_xml_files, number_of_apps_per_category
    cfg = json.load(open('./config/data-params.json'))
    get_apk(**cfg)