import pandas as pd
import numpy as np
import requests
from bs4 import BeautifulSoup
import time
from selenium import webdriver
import os


def getMalwareData(url):
    df = pd.read_html(url)
    return df[2]

def concatDataFrame(df):
    fam = df['Family']
    info = df['Information']
    comp = df['Composition']
    install = df['Installation']
    act = df['Activation']
    steal = df['Information_Stealing']
    persistence = df['Persistence']
    priv = df['Privilege']
    anti = df['Anti-analysis']
    mon = df['Monetization']

    result = pd.concat([fam, info, comp, install, act, steal, persistence, priv, anti, mon], axis=1, join='inner')
    return result

def completeMalwareData(df, malType):

    result = concatDataFrame(df)
    if malType != None:
        result = result.loc[result['Malware_Type'] == malType]

    return result


def condensedMalwareData(df, malType):
    fam = df['Family']
    info = df['Information']

    result = pd.concat([fam, info], axis=1, join='inner')
    result = result.drop(['Creation_Date', 'Detected_Date'], axis=1)
    if malType != None:
        result = result.loc[result['Malware_Type'] == malType]

    return result


def condensedFaimlyData(df, family):
    fam = df['Family']
    info = df['Information']

    result = pd.concat([fam, info], axis=1, join='inner')
    result = result.drop(['Creation_Date', 'Detected_Date'], axis=1)
    if family != None:
        result = result.loc[result['Family'] == family]

    return result


def completeFaimlyData(df, family):

    result = concatDataFrame(df)
    if family != None:
        result = result.loc[result['Family'] == family]

    return result
